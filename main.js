import content from '../content.json' assert { type:'json' };
import { initThree } from './three-scene.js';
const $=(s,sc=document)=>sc.querySelector(s);
function buildServices(lang='en'){const c=$('#servicesList');c.innerHTML='';content.services.forEach(s=>{const t=s[lang]||s.en;const [ti,de]=t.split(' — ');const el=document.createElement('div');el.className='service-card';el.innerHTML=`<h3>${ti}</h3><p>${de||''}</p>`;c.appendChild(el);});}
function buildGallery(){const g=$('#gallery');g.innerHTML='';(content.stock||[]).forEach((u,i)=>{const img=new Image();img.src=u;img.alt=`Portfolio ${i+1}`;g.appendChild(img);});}
function buildTestimonials(lang='en'){const t=$('#testimonials');t.innerHTML='';content.testimonials.forEach(o=>{const el=document.createElement('article');el.className='testimonial';el.innerHTML=`<strong>${o.name} — ${o.city}</strong><p>${o[lang]||o.en}</p>`;t.appendChild(el);});}
function setupLang(){const tg=$('#langToggle');const bn=$('#brandName');const sl=$('#slogan');let lang=localStorage.getItem('lang')||'en';tg.checked=lang==='en';function apply(){bn.textContent=content.brand.name;sl.textContent=content.brand.slogan[lang];buildServices(lang);buildTestimonials(lang);document.documentElement.lang=lang;}tg.addEventListener('change',()=>{lang=tg.checked?'en':'es';localStorage.setItem('lang',lang);apply();});apply();}
function setupHoriz(){const panels=gsap.utils.toArray('.panel');const container=document.querySelector('.horiz-container');if(innerWidth>720){gsap.to(panels,{xPercent:-100*(panels.length-1),ease:'none',scrollTrigger:{trigger:'.horiz-wrapper',pin:true,scrub:.8,end:()=>'+='+container.offsetWidth,snap:1/(panels.length-1),invalidateOnRefresh:true}});}}
(function init(){setupLang();buildGallery();setupHoriz();initThree();})();